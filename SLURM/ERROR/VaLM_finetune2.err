myscripts/train_valmA100_finetune2.sh: line 9: 
DATA_DIR=./data/finetune_data
CKPT_DIR=./CHECKPOINTS/checkpoint_valmA100_40600upd_lrx4_more_finetune3
CKPT_DIR_R=./CHECKPOINTS/checkpoint_valmA100_40600upd_lrx4
DATASTORE_DIR=./data/image_features_datastore
K=4

srun torchrun --nproc_per_node=4 fairseq/fairseq_cli/train.py ${DATA_DIR} --save-dir ${CKPT_DIR} --task language_modeling --arch transformer_lm_gpt --share-decoder-input-output-embed --dropout 0.1 --optimizer adam --adam-betas (0.9, 0.98) --weight-decay 0.01 --clip-norm 2.0 --lr 0.002 --lr-scheduler inverse_sqrt --tokens-per-sample 512 --sample-break-mode none --max-tokens 65536 --max-update 6000 --save-interval-updates 1000 --disable-validation  --use-knn-datastore --use-joint-attention --joint-layer-index 2  --ddp-backend legacy_ddp --wandb-project VaLM-baseline --fp16 --finetune-from-model ${CKPT_DIR_R}/checkpoint_last.pt
: No such file or directory
[2024-04-21 01:49:17,030] torch.distributed.run: [WARNING] 
[2024-04-21 01:49:17,030] torch.distributed.run: [WARNING] *****************************************
[2024-04-21 01:49:17,030] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-04-21 01:49:17,030] torch.distributed.run: [WARNING] *****************************************
/ikerlariak/pontalvilla001/VaLM/fairseq/fairseq/distributed/utils.py:620: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:83.)
  all_gather_list._buffer = torch.cuda.ByteTensor(buffer_size)
/ikerlariak/pontalvilla001/VaLM/fairseq/fairseq/distributed/utils.py:620: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:83.)
  all_gather_list._buffer = torch.cuda.ByteTensor(buffer_size)
/ikerlariak/pontalvilla001/VaLM/fairseq/fairseq/distributed/utils.py:620: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:83.)
  all_gather_list._buffer = torch.cuda.ByteTensor(buffer_size)
/ikerlariak/pontalvilla001/VaLM/fairseq/fairseq/distributed/utils.py:620: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:83.)
  all_gather_list._buffer = torch.cuda.ByteTensor(buffer_size)
wandb: Currently logged in as: paula-ontalvilla (paulaixa). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.6 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.1
wandb: Run data is saved locally in /ikerlariak/pontalvilla001/VaLM/wandb/run-20240421_014947-8dfixun4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run checkpoint_gpt_blind_lrx4_40600upd_more_finetune2
wandb: â­ï¸ View project at https://wandb.ai/paulaixa/VaLM-baseline
wandb: ğŸš€ View run at https://wandb.ai/paulaixa/VaLM-baseline/runs/8dfixun4
/ikerlariak/pontalvilla001/VaLM/VaLM_ve_image/lib/python3.9/site-packages/torch/nn/functional.py:5076: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
/ikerlariak/pontalvilla001/VaLM/VaLM_ve_image/lib/python3.9/site-packages/torch/nn/functional.py:5076: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
/ikerlariak/pontalvilla001/VaLM/VaLM_ve_image/lib/python3.9/site-packages/torch/nn/functional.py:5076: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
/ikerlariak/pontalvilla001/VaLM/VaLM_ve_image/lib/python3.9/site-packages/torch/nn/functional.py:5076: UserWarning: Support for mismatched key_padding_mask and attn_mask is deprecated. Use same type for both instead.
  warnings.warn(
wandb: 
wandb: Run history:
wandb:              train/bsz â–â–ƒâ–ƒâ–ˆ
wandb:             train/clip â–ˆâ–â–â–
wandb:          train/gb_free â–â–â–â–
wandb:            train/gnorm â–ˆâ–ƒâ–‚â–
wandb:             train/loss â–ˆâ–…â–ƒâ–
wandb:       train/loss_scale â–â–â–â–
wandb:               train/lr â–â–„â–†â–ˆ
wandb:              train/ppl â–ˆâ–…â–‚â–
wandb:       train/train_wall â–ˆâ–ƒâ–ƒâ–
wandb:              train/ups â–â–ƒâ–ƒâ–ˆ
wandb:             train/wall â–â–„â–‡â–ˆ
wandb:              train/wpb â–â–ƒâ–ƒâ–ˆ
wandb:              train/wps â–â–ƒâ–ƒâ–ˆ
wandb:        train_inner/bsz â–
wandb:       train_inner/clip â–
wandb:    train_inner/gb_free â–
wandb:      train_inner/gnorm â–
wandb:       train_inner/loss â–
wandb: train_inner/loss_scale â–
wandb:         train_inner/lr â–
wandb:        train_inner/ppl â–
wandb: train_inner/train_wall â–
wandb:        train_inner/ups â–
wandb:       train_inner/wall â–
wandb:        train_inner/wpb â–
wandb:        train_inner/wps â–
wandb: 
wandb: Run summary:
wandb:              train/bsz 507.1
wandb:             train/clip 0.0
wandb:          train/gb_free 12.8
wandb:            train/gnorm 0.318
wandb:             train/loss 4.038
wandb:       train/loss_scale 4.0
wandb:               train/lr 5e-05
wandb:              train/ppl 16.43
wandb:       train/train_wall 11.0
wandb:              train/ups 0.67
wandb:             train/wall 227.0
wandb:              train/wpb 259640.9
wandb:              train/wps 174962.0
wandb:        train_inner/bsz 500.8
wandb:       train_inner/clip 14.0
wandb:    train_inner/gb_free 12.8
wandb:      train_inner/gnorm 0.913
wandb:       train_inner/loss 4.346
wandb: train_inner/loss_scale 4.0
wandb:         train_inner/lr 5e-05
wandb:        train_inner/ppl 20.33
wandb: train_inner/train_wall 74.0
wandb:        train_inner/ups 0.51
wandb:       train_inner/wall 211.0
wandb:        train_inner/wpb 256408.5
wandb:        train_inner/wps 131904.5
wandb: 
wandb: ğŸš€ View run checkpoint_gpt_blind_lrx4_40600upd_more_finetune2 at: https://wandb.ai/paulaixa/VaLM-baseline/runs/8dfixun4
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240421_014947-8dfixun4/logs
